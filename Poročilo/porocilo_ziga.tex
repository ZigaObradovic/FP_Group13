\documentclass[11pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[slovene]{babel}
\usepackage{amsmath,amssymb}
\usepackage{graphicx}
\usepackage{geometry}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{float}
\usepackage[table]{xcolor}
\usepackage{siunitx}
\sisetup{
  group-separator = {.},
  group-minimum-digits = 3
}
\geometry{margin=2.5cm}

\title{Tukaj pišem svoj del, da bova kasneje združila}
\author{Žiga}
\date{\today}

\begin{document}
\maketitle

\section{Uvod}

V projektu obravnavamo domnevo, ki govori o minimizaciji števila poti v razredu kubičnih grafov, torej grafov, kjer ima vsako vozlišče stopnjo 3. Za dani povezani graf $G$ definiramo \textit{subpath number}, označen s $pn(G)$, kot število vseh preprostih poti v grafu, vključno s trivialnimi potmi dolžine 0. Preprosta pot je zaporedje vozlišč $(v_0, v_1, \dots, v_\ell)$ brez ponovitev, kjer je vsak par zaporednih vozlišč povezan z robom.\\

V literaturi je bila postavljena domneva, da za vsako sodo število vozlišč $n$ obstaja natanko en kubični graf $L_n$, ki ima najmanjši subpath number med vsemi kubičnimi grafi z $n \geq 10$ vozlišči. Grafi $L_n$ so sestavljeni iz več kopij grafa $K_4 - e$ (popolnega grafa na štirih vozliščih, iz katerega odstranimo en rob), ki jih povežemo v verižni strukturi. Na obeh koncih se tej verigi dodata še posebna \textit{pendant bloka} - eden na 5, drugi pa na 7 vozlišč.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.7\textwidth]{slike/Ln_graf.png}
    \caption{$L_n$ grafa za $n = 18$ in $20$}
    \label{fig:Ln}
\end{figure}

Kasneje se je pokazalo, da domneva za dovolj velika $n$ ne drži,
vendar še ni znano, pri katerem najmanjšem $n$ se pojavi prva protimera.
Namen našega projekta je torej:
\begin{itemize}
    \item preveriti domnevo za manjša, obvladljiva števila vozlišč $n$,
    \item in poskusiti poiskati protimer, torej kubični graf z manjšim
    subpath number kot $L_n$.
\end{itemize}

\section{Preverjanje domneve za majhne n}

Če smo domnevo želeli preveriti na vseh kubičnih grafih na $n$ vozliščih, smo morali najprej te grafe generirati. Izkazalo se je, da številov kubičnih grafov na $n$ vozliščih eksponentno raste s številom vozlišč, zato smo domnevo preverili na vseh kubičnih grafih le za $n \leq 18$.

\begin{table}[H]
\centering
\begin{tabular}{cc}
\toprule
$n$ & \# kubičnih grafov \\
\midrule
10  & \num{19} \\
12  & \num{85} \\
14  & \num{509} \\
16  & \num{4060} \\
18  & \num{41301} \\
20  & \num{510489} \\
22  & \num{7319447} \\
\bottomrule
\end{tabular}
\caption{Število neizomorfnih povezanih kubičnih grafov na $n$ vozliščih.}
\label{tab:st_grafov}
\end{table}

Za $n \in \{10, ~12, ~14, ~16, ~18\}$ smo pridobili vse neizomorfne povezane kubične grafe na $n$ vozliščih in za vsak graf $G$ izračunali $pn(G)$. Za vsak $n$ smo posebej primerjali število poti generiranega grafa $pn(G)$ s številom poti grafa $L_n$ $pn(L_n)$. Rezultati so prikazani v spodnji tabeli.

\begin{table}[H]
\centering
\begin{tabular}{cccc}
\toprule
$n$ & število boljših grafov & minimalno število poti & $pn(L_n)$\\
\midrule
10  & \num{0} & \num{1276} & \num{1276}\\
12  & \num{0} & \num{3076} & \num{3076}\\
14  & \num{0} & \num{5504} & \num{5504}\\
16  & \num{6} & \num{3640} & \num{12744}\\
18  & \num{23} & \num{7072} & \num{22532}\\
\bottomrule
\end{tabular}
\caption{Število vseh grafov na $n$ vozliščih z manjšim številom poti od grafa $L_n$.}
\label{tab:rezultat_generiranja}
\end{table}

Na podlagi rezultatov vidimo, da domneva velja za $n \in \{10, ~12, ~14\}$, medtem ko lahko domnevo za $n \in \{16, ~18\}$ zavrnemo. Namreč v primeru ko je $n=16$ smo našli 6 grafov z manjišim številom poti od grafa $L_{16}$, v primeru $n = 18$ pa že kar 23 grafov z manjišim številom poti od grafa $L_{18}$.

\begin{figure}[H]
\centering
\includegraphics[width=0.85\textwidth]{slike/n18_grafi.png}
\caption{Grafi z najmanjšim številom poti za $n=18$.}
\label{fig:n18_grafi}
\end{figure}

Ker je za $n \geq 20$ izračun \emph{subpath number} vedno zahtevnejši, grafov pa vedno več, bomo za iskanje protiprimerov uporabili drugačno metodo. Ta metoda se mimenuje \emph{simulated annealing}. 

\section{Simulated annealing}

Za iskanje kubičnih grafov z manjšim številom poti od $L_n$ grafa smo za $n \geq 20$ uporabili metahevristični algoritem \emph{simulated annealing} (SA). Gre za 
probabilistično metodo globalne optimizacije, ki posnema proces 
fizikalnega ohlajanja kovin: sistem se sprva nahaja pri visoki temperaturi 
in lahko sprejema tudi poslabšanja, postopoma pa se temperatura znižuje, 
kar zmanjšuje verjetnost sprejemanja slabših rešitev. Pri dovolj počasnem 
ohlajanju se algoritem z visoko verjetnostjo približa globalnemu minimumu
energetske funkcije, katera je v našem primeru \emph{subpath number}.

\subsection{Delovanje}

V našem primeru je prostor iskanja sestavljen iz vseh \emph{povezanih 
kubičnih grafov} na $n$ vozliščih. Prehod med grafi definiramo s t.\ i. 
\emph{dvojnim prevezovanjem robov} (ang.~double-edge swap). Naj bo 
$G = (V,E)$ kubičen graf in naj bosta izbrani dve disjunktni povezavi 
$\{u,v\},\{x,y\} \in E$. Zamenjava poteka tako, da se povezavi odstranita 
in nadomestita z novima paroma $\{u,x\}$ in $\{v,y\}$ ali s paroma 
$\{u,y\}$ in $\{v,x\}$. S takimi menjavami povezav ohranimo 3-regularnost grafa. Energijska funkcija, ki jo minimiziramo, pa je v našem primeru podana z $E(G) = \text{subpath\_number}(G),$
kjer funkcija $\text{subpath\_number}(\cdot)$ prešteje vse različne 
poti v grafu.\\

Proces začnemo z grafom, ki ga želimo izboljšati. V našem primeru je to graf $L_n =: G$. Pri vsakem koraku z double edge swap generiramo novega soseda $G'$ in izračunamo $\Delta E = E(G') - E(G)$.
Če je $\Delta E \le 0$, rešitev sprejmemo. V nasprotnem primeru jo sprejmemo z verjetnostjo $$p = \exp\!\left(-\frac{\Delta E}{T}\right),$$
kjer $T>0$ predstavlja trenutni temperaturni parameter. 
S tem omogočimo kontrolirano sprejemanje slabših rešitev zgodaj v 
postopku, kar preprečuje prezgodnjo ujetost v lokalne minimume. Če rešitev sprejmemo nastavimo $G := G'$ in postopek ponavljamo.\\

V našem primeru smo naredili \num{20000} ponovitev postopka, začetni parameter $T_0$ pa je bil nastavljen tako, da se je v zgodnjih ponovitvah slabša rešitev sprejela z verjetnostjo približno 40 \%, proti koncu postopka pa skoraj nikoli.

\subsection{Rezultati}

Z metodo \emph{simulated annealing} smo za $n \in \{20, ~22, ~\dots, ~30\}$ iskali grafe z manjšim številom poti od grafa $L_n$. Rezultati so v spodnji tabeli.

\begin{table}[H]
\centering
\begin{tabular}{cccc}
\hline
n & $subpath\_number(L_n)$ & boljši $subpath\_number$ & razlika \\
\hline
20 & \num{51532}  & \num{11708} & \num{38716} \\
22 & \num{90760}  & \num{7156}  & \num{83604} \\
24 & \num{206800} & \num{12220} & \num{194580} \\
26 & \num{363788} & \num{21760} & \num{342028} \\
28 & \num{827988} & \num{29568} & \num{798420} \\
30 & \num{1456016} & \num{18520} & \num{1437496} \\
\hline
\end{tabular}
\caption{Rezultati SA.}
\label{tab:Results_SA}
\end{table}

Ker smo našli grafe z manjšim številom poti, smo torej domnevo, da imajo grafi $L_n$ najmanjše število poti, zavrnili tudi za $n \in \{20, ~22, ~\dots, ~30\}$.

\begin{figure}[H]
\centering
\includegraphics[width=0.85\textwidth]{slike/SA_potek.png}
\caption{Potek energije med simulated annealing za $n = 20$.}
\label{fig:SA_potek}
\end{figure}

Na sliki lahko vidimo potek energije (števila poti) med procesom SA za $n=20$. Kar lahko razberemo je, da so se med postopkom sprejele tudi slabše rešitve, saj energija ni strogo padajoča. Program je uspešno sprejemal tudi sabše rešitve in se s tem izognil morebitnim lokalnim minimumom. Vselej pa smo na koncu našli graf s kar 5-krat manjšim številom poti ob grafa $L_{20}$. Čeprav samo na podlagi rezultatov SA še ne moremo trditi, da je \num{11706} najmanjše število poti za $n = 20$, bomo kasneje dokazali, da je to pravzaprav res in da smo s postopkom SA našli graf, ki minimizira število poti za $n=20$.

\begin{figure}[H]
\centering
\includegraphics[width=0.4\textwidth]{slike/cat2_20.png}
\caption{Graf dobljen s SA za $n = 20$.}
\label{fig:Cat2_20}
\end{figure}

Vredno je poudariti, da v splošnem z najdenimi grafi še zdaleč ne minimiziramo števila poti za inzbrani $n$, čeprav so za nekatere $n$ najdeni grafi že precej dobri. Našli smo le primere grafov z manjšim številom poti od opazovanega $L_n$ grafa. To se dobro vidi, ko primerjamo dobljeno minimalno število poti za $n=28$ in $n=30$. Dobljeni graf za $n=30$ ima namreč kar za tretjino manj poti od dobljenega grafa za $n=28$. Ta podatek nam za graf z $n=30$ sicer ne pove veliko, medtem ko smo lahko skoraj prepričani, da za $n=28$ obstaja graf z manjšim številom poti.



\begin{figure}[H]
\centering
\includegraphics[width=0.85\textwidth]{slike/SA_grafi.png}
\caption{Grafi pridobljeni s SA za $n =$ 26, 28 in $n=30$.}
\label{fig:SA_grafi}
\end{figure}

\section{Testiranje hipoteze}

Število poti na novo konstruiranih grafov smo sedaj primerjali neposredno z grafi $L_n$. Rezultati izračunov za $n \in \{16, 18, \dots, 40\}$ so predstavljeni v spodnji tabeli.

\begin{table}[H]
\centering
\begin{tabular}{ccccc}
\hline
$n$ & $\mathrm{pn}(L_n)$ & $\mathrm{pn(Tree)}$ & $\mathrm{pn(Cat1)}$ & $\mathrm{pn(Cat2)}$ \\
\hline
16 & \num{12744}   & \num{3640}  & \num{3640}  & \num{3640}  \\
18 & \num{22532}   & \num{7072}  & \num{7072}  & \num{7072}  \\
20 & \num{51532}   & \num{12816} & \num{12816} & \cellcolor{yellow!50}\num{11708} \\
22 & \num{90760}   & \num{7156}  & \num{7156}  & \num{7156}  \\
24 & \num{206800}  & \num{12220} & \num{12220} & \num{12220} \\
26 & \num{363788}  & \num{19596} & \num{19596} & \cellcolor{yellow!50}\num{19064} \\
28 & \num{827988}  & \num{11824} & \num{11824} & \num{11824} \\
30 & \num{1456016} & \num{18520} & \num{18520} & \num{18520} \\
32 & \num{3312856} & \num{27528} & \num{27528} & \cellcolor{yellow!50}\num{27572} \\
34 & \num{5825044} & \num{17644} & \num{17644} & \num{17644} \\
36 & \num{13252444} & \num{25972} & \num{25972} & \num{25972} \\
38 & \num{23301272} & \num{36612} & \num{36612} & \cellcolor{yellow!50}\num{37232} \\
40 & \num{53010912} & \num{24616} & \num{24616} & \num{24616} \\
\hline
\end{tabular}
\caption{Primerjava $\mathrm{pn}(L_n)$ s tremi različnimi konstrukcijami.}
\label{tab:pn_comparison}
\end{table}

Hitro opazimo, da imajo vse tri konstrukcije veliko manjše število poti kot graf $L_n$. V primeru $n=40$ imajo naše konstrukcije kar \num{2153}-krat manjše število poti kot graf $L_{40}$. Opazimo lahko tudi, da imata grafa \emph{Cat1} in \emph{Tree} isto število poti. Njun subpath number se namreč ujema vse do $n=300$ (Testirali smo samo do $n=300$). To glede na njuno konstrukcijo ni nič presenetljivega, saj ju sestavlja isto število glavnih gradnikov in tudi število povezav med posameznimi gradniki je enako.\\

\noindent\textbf{VERJETNO POPRAVEK: GLEDE NA RAZDELEK O KONSTRUKCIJAH}

Poleg vsega opazimo tudi razliko v številu poti med konstrukcijama \emph{Cat1} in \emph{Cat2}. Razlike se pojavijo pri $n = 6k+2$ za $k = 2,~3,~4,\dots$, kar bi lahko pričakovali, saj sta grafa različno konstruirana ravno pri teh $n$. Kot vidimo na spodnji sliki, se konstrukciji pri $n=26$ razlikujeta v treh ključnih gradnikih. Če izhajamo iz konstrukcije \emph{Cat1} oz. \emph{Cat2} na 22 vozliščih (konstrukciji sta za $n=22$ enaki), opazimo, da pri konstrukciji \emph{Cat1} 4 nova vozlišča vpeljemo tako, da dva skrajna pendant bloka na 5 vozliščih zamenjamo z dvema pendant blokoma na 7 vozliščih. Pri konstrukciji \emph{cat2} pa 4 nova vozlišča vpeljemo tako, da med pendant bloke na 5 vozliščih vrninemo graf $K_4 - e$.

\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{slike/Cat12_26.png}
\caption{Konstrukciji \emph{Cat1} (levo) in \emph{Cat2} (desno) za $n=26$.}
\label{fig:Cat12_26}
\end{figure}

Zanimivo je, da ni ena izmed konstrukcij zmeraj boljša. Za $n \in \{14, ~20, ~26\}$ ima namreč najmanjše število poti \emph{Cat2}, medtem ko je za $n  \in \{32, ~38, ~44, \dots\}$ boljši graf \emph{Cat1}.

\begin{table}[H]
\centering
\begin{tabular}{ccc}
\hline
$n$ & $\mathrm{pn(Cat1)}$ & $\mathrm{pn(Cat2)}$ \\
\hline
14 & \num{7188}   & \cellcolor{green!30}\num{5504} \\
20 & \num{12816}  & \cellcolor{green!30}\num{11708} \\
26 & \num{19596}  & \cellcolor{green!30}\num{19064} \\
32 & \cellcolor{green!30}\num{27528}  & \num{27572} \\
38 & \cellcolor{green!30}\num{36612}  & \num{37232} \\
44 & \cellcolor{green!30}\num{46848}  & \num{48044} \\
50 & \cellcolor{green!30}\num{58236}  & \num{60008} \\
56 & \cellcolor{green!30}\num{70776}  & \num{73124} \\
62 & \cellcolor{green!30}\num{84468}  & \num{87392} \\
68 & \cellcolor{green!30}\num{99312}  & \num{102812} \\
74 & \cellcolor{green!30}\num{115308} & \num{119384} \\
80 & \cellcolor{green!30}\num{132456} & \num{137108} \\
\hline
\end{tabular}
\caption{Primerjava števila poti med strukturama Cat1 in Cat2.}
\label{tab:cat1_cat2}
\end{table}

Če podrobno pogledamo rezultate primerjave števila poti grafov $L_n$ z našimi konstrukcijami opazimo, da prav za $n = 6k+2$ za $k = 2,~3,~4,\dots$ število poti v naših konstrukcijah doživi velik narast in ima višjo vrednost kot njegov naslednik $n + 2$ ali celo $n+4$. Ker se nam to ni zdelo smiselno, smo za $n = 20$ vrednost $\mathrm{pn(Cat2)}$, katera je za ta $n$ med našimi konstrukcijami najnižja, primerjali z vsemi kubičnimi grafi na $20$ vozliščih. Ugotovili smo, da graf \emph{Cat2} med kubičnimi grafi na $20$ vozliščih minimizira število poti. To pomeni, da glede tega skoka ne moremo narediti nič. To pomeni, da število poti ni povsem odvisno od števila vozlišč, pomembni so le posamezni gradniki znotraj grafa, katerih za $n = 6k+2$ ne moremo konstruirati. 

\begin{table}[H]
\centering
\begin{tabular}{ccccc}
\hline
$n$ & $\mathrm{pn}(L_n)$ & $\mathrm{pn(Tree)}$ & $\mathrm{pn(Cat1)}$ & $\mathrm{pn(Cat2)}$ \\
\hline
16 & \num{12744}   & \num{3640}  & \num{3640}  & \num{3640}  \\
18 & \num{22532}   & \num{7072}  & \num{7072}  & \num{7072}  \\
20 & \num{51532}   & \cellcolor{yellow!50}\num{12816} & \cellcolor{yellow!50}\num{12816} & \cellcolor{yellow!50}\num{11708} \\
22 & \num{90760}   & \num{7156}  & \num{7156}  & \num{7156}  \\
24 & \num{206800}  & \num{12220} & \num{12220} & \num{12220} \\
26 & \num{363788}  & \cellcolor{yellow!50}\num{19596} & \cellcolor{yellow!50}\num{19596} & \cellcolor{yellow!50}\num{19064} \\
28 & \num{827988}  & \num{11824} & \num{11824} & \num{11824} \\
30 & \num{1456016} & \num{18520} & \num{18520} & \num{18520} \\
32 & \num{3312856} & \cellcolor{yellow!50}\num{27528} & \cellcolor{yellow!50}\num{27528} & \cellcolor{yellow!50}\num{27572} \\
34 & \num{5825044} & \num{17644} & \num{17644} & \num{17644} \\
36 & \num{13252444} & \num{25972} & \num{25972} & \num{25972} \\
38 & \num{23301272} & \cellcolor{yellow!50}\num{36612} & \cellcolor{yellow!50}\num{36612} & \cellcolor{yellow!50}\num{37232} \\
40 & \num{53010912} & \num{24616} & \num{24616} & \num{24616} \\
\hline
\end{tabular}
\caption{Skok števila poti za $n = 6k+2$.}
\label{tab:pn_comparison2}
\end{table}

Za skok števila poti so zagotovo krivi \textbf{podaljšani} gradniki. V konstrukcijah \emph{cat1} in \emph{Tree}, ko iz $n = 6k$ preidemo v $n = 6k+2$, dve dodatni vozlišči vpeljemo tako, da enemu podaljšanemu gradniku dodamo še drugega namesto enega \textbf{pendant bloka}. Tu se v smislu števila poti naredi največji skok. Ko pa $n$ povečamo še za 2, torej $n = 6k+4$, ta dva podlajšana gradnika zamenjamo s tremi pendant bloki, kar nam število poti ponovno zmanjša. Vse tri konstrukcije in njihove razlike so predstavljene na spodnji sliki.

\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{slike/Tree3.png}
\caption{Razlike v konstrukcijah \emph{tree} za $n=36$ (levo), $n=38$ (srednji) in $n=40$ (desno).}
\label{fig:Tree3}
\end{figure}

\subsection{Simulated annealing}

Želimo vedeti, ali naše konstrukcije minimizirajo število poti za kubične grafe na $n$ vozliščih. Ker smo za $n \in \{10, ~12, ~14, ~16, ~18, ~20\}$ pregledali vse kubične grafe, lahko z gotovostjo trdimo, da konstrukcija \emph{Cat2} minimizira subpath number za kubične grafe na $n$ vozliščih za $n \in \{10, ~12, ~14, ~16, ~18, ~20\}$.\\

Sedaj trdimo, da so naše konstrukcije tiste, ki minimizirajo število poti na kubičnih grafih. Podobno kot smo to domnevo raziskovali za $L_n$ grafe, smo tudi za te grafe protiprimere iskali s \emph{simulated annealing} metodo. Metodo smo preizkusili za $n \in \{22, ~24, ~26\}$, kjer smo prvič za začetni približek uporabili konstrukcijo \emph{Cat1}, drugič pa še konstrukcijo \emph{Tree}. V obeh primerih nam je metoda za $n=22$ in $n=24$ vrnila kar $\mathrm{pn(Cat1)}$ oziroma $\mathrm{pn(Tree)}$, prav tako pa je v primeru $n=26$ našla nižji subpath number, kateri se ujema s $\mathrm{pn(Cat1)}$. Vse vrednosti so nam bile tako že znane, kar pomeni, da z metodo \emph{simulated annealing} nismo našli kubičnih grafov na n vozliščih, z nižjim številom poti od naših konstrukcij za $n \in \{22, ~24, ~26\}$. 

\begin{figure}[H]
\centering
\includegraphics[width=0.85\textwidth]{slike/SA_potekCat26.png}
\caption{Potek energije med simulated annealing za $n=26$ z začetnim približkom \emph{Cat1}.}
\label{fig:SA_potekCat}
\end{figure}

Kar bi nas pri tej ugotovitvi lahko skrbelo je, da se je algoritem SA zataknil v nekem lokalnem minimumu. Vendar iz grafa poteka energije na sliki lepo vidimo, da je algoritem obravnaval tudi druge grafe s precej višjim številom poti. V prvih \num{2000} korakih je namreč sprejel približno $35 ~\%$ vseh slabših rešitev, kasneje pa vedno manj. Vsekakor pa to ne pomeni, da lahko z gotovostjo trdimo, da naše konstrukcije minimizirajo število poti med kubičnimi grafi, saj bi morali za to obravnavati čisto vse grafe, kot smo jih za $n \leq 20$.

\section{Zaključek}

\end{document}